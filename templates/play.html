<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playing - Hidden Ties Plus</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/play.css') }}">
</head>
<body class="play-body">
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <div class="play-background" aria-hidden="true"></div>
    
    <!-- Top Bar -->
    <header class="play-header">
        <a href="{{ url_for('home') }}" class="back-btn">
            <span>‚Üê</span> Exit
        </a>
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <span class="progress-text" id="progressText">1 / {{ questions | length }}</span>
        </div>
        <div class="player-indicator" id="playerIndicator">
            Player <span id="currentPlayer">1</span>
        </div>
    </header>

    <!-- Main Card Area -->
    <main class="play-container" id="main-content">
        <div class="card-stack">
            <div class="card-wrapper" id="cardWrapper">
                <div class="game-card" id="gameCard">
                    <div class="card-inner">
                        <div class="card-type-badge" id="cardTypeBadge">Question</div>
                        <div class="card-text" id="cardText"></div>
                        <div class="card-pack" id="cardPack"></div>
                    </div>
                    <div class="card-glow" aria-hidden="true"></div>
                </div>
            </div>
            
            <!-- Swipe Hints -->
            <div class="swipe-hint left" aria-hidden="true">
                <span>‚Üê</span>
            </div>
            <div class="swipe-hint right" aria-hidden="true">
                <span>‚Üí</span>
            </div>
        </div>

        <!-- Navigation Controls -->
        <div class="controls">
            <button class="control-btn prev" id="prevBtn" disabled>
                <span class="control-icon">‚Üê</span>
                <span class="control-text">Back</span>
            </button>
            
            <button class="control-btn skip" id="skipBtn">
                <span class="control-icon">‚Ü∑</span>
                <span class="control-text">Skip</span>
            </button>
            
            <button class="control-btn next" id="nextBtn">
                <span class="control-text">Next</span>
                <span class="control-icon">‚Üí</span>
            </button>
        </div>
    </main>

    <!-- Game Complete Modal -->
    <div class="modal" id="completeModal" role="dialog" aria-modal="true" aria-labelledby="completeTitle" aria-describedby="completeDesc">
        <div class="modal-content complete-modal">
            <div class="modal-emoji" aria-hidden="true">üéâ</div>
            <h2 id="completeTitle">Amazing Session!</h2>
            <p id="completeDesc" class="complete-stats">You played through all {{ questions | length }} cards</p>
            <div class="modal-actions">
                <a href="{{ url_for('home') }}" class="modal-btn secondary">New Game</a>
                <button class="modal-btn primary" onclick="restartGame()">Play Again</button>
            </div>
        </div>
    </div>

    <!-- Pass Phone Modal (for multiplayer) -->
    <div class="modal" id="passModal" role="dialog" aria-modal="true" aria-labelledby="passTitle" aria-describedby="passDesc">
        <div class="modal-content pass-modal">
            <div class="modal-emoji" aria-hidden="true">üì±</div>
            <h2 id="passTitle">Pass to Player <span id="nextPlayerNum">2</span></h2>
            <p id="passDesc" class="pass-subtitle">Hand the phone to the next player</p>
            <button class="modal-btn primary large" onclick="closePassModal()">
                I'm Ready
            </button>
            <p class="pass-hint">Tap when the next player is ready</p>
        </div>
    </div>

    <!-- Confetti Canvas -->
    <canvas id="confettiCanvas" aria-hidden="true"></canvas>

    <script>
        const questions = {{ questions | tojson | safe }};
        const playerCount = {{ player_count }};
        const gameMode = "{{ game_mode }}";
    </script>
    <script src="{{ url_for('static', filename='js/play.js') }}"></script>
</body>
</html>
